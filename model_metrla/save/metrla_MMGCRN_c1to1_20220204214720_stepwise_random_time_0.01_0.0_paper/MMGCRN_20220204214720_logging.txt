experiment_city metrla
model_name MMGCRN
memory_type local
mem_num 10
mem_dim 32
meta_type yes
decoder_type stepwise
ycov_type time
separate loss lamb 0.01
compact loss lamb1 0.0
batch_size 64
rnn_units 32
num_layers 1
channnel_in 1
channnel_out 1
feature_time True
feature_history False
metrla training started Fri Feb  4 21:47:26 2022
TRAIN XS.shape YS.shape, XCov.shape, YCov.shape (27394, 12, 207, 1) (27394, 12, 207, 1) (27394, 12, 207, 1) (27394, 12, 207, 1)
Model Training Started ... Fri Feb  4 21:47:28 2022
TIMESTEP_IN, TIMESTEP_OUT 12 12
Trainable parameter list: 
 
 In total: 51129 trainable parameters. 
 
XS_torch.shape:   torch.Size([27394, 12, 207, 1])
YS_torch.shape:   torch.Size([27394, 12, 207, 1])
YCov_torch.shape:   torch.Size([27394, 12, 207, 1])
epoch 0 time used: 43  seconds  train loss: 0.3701790399565616 0.3599045729302928 1.0274467266587193 0.18485410938031574 validation loss: 0.28757436151052046 0.2796982417968068 0.7876119162218415 0.15536510053777347
epoch 1 time used: 47  seconds  train loss: 0.2674537865404064 0.2587833367538341 0.8670450383961645 0.1412437324094292 validation loss: 0.27195968910290375 0.2641243317092422 0.7835357044735094 0.13104866806608048
epoch 2 time used: 48  seconds  train loss: 0.2677989726836185 0.26083470259673547 0.6964270095064452 0.11382744890229365 validation loss: 0.27107190598536585 0.2649945803802379 0.6077325866344201 0.09587441979316029
epoch 3 time used: 43  seconds  train loss: 0.25969967082490353 0.2541964585585938 0.5503212733692279 0.08186895034999318 validation loss: 0.2664385014511373 0.26134817406208843 0.5090328070021024 0.07107516021732867
epoch 4 time used: 42  seconds  train loss: 0.24960120226396001 0.24504146964008208 0.455973225804134 0.06537988467776182 validation loss: 0.26738392236894065 0.2635514342349811 0.38324878381116545 0.056925729553412345
epoch 5 time used: 42  seconds  train loss: 0.257557835706712 0.2538093917969843 0.37484443167384535 0.04687143894761578 validation loss: 0.259985595258483 0.25742006486349733 0.25655295769228553 0.030485793378775137
epoch 6 time used: 42  seconds  train loss: 0.24464939579487624 0.24336992461131599 0.1279470901079145 0.026337444260508176 validation loss: 0.2546795277743444 0.2537203746120425 0.09591532638038162 0.0247979230069331
epoch 7 time used: 42  seconds  train loss: 0.24210312234787904 0.24120483728949968 0.0898285247848657 0.02526772319070687 validation loss: 0.24803238575911 0.24703317690504728 0.09992091045653732 0.022366601596892317
epoch 8 time used: 42  seconds  train loss: 0.2418486354293252 0.2410556537817345 0.07929817916599043 0.025871628745731356 validation loss: 0.24981215084121175 0.24890731385589515 0.09048366919268656 0.025005952534775663
epoch 9 time used: 45  seconds  train loss: 0.2386554517571502 0.23787364336813568 0.07818089834321519 0.022365441182547068 validation loss: 0.2574333152892816 0.2564789955067809 0.09543189360495032 0.01802387678547062
epoch 10 time used: 44  seconds  train loss: 0.24268856681372 0.24179813176961729 0.08904354446013324 0.02718374846298993 validation loss: 0.2618705674636103 0.2605395733222474 0.1330994505603818 0.03262539251170454
epoch 11 time used: 41  seconds  train loss: 0.23872742183608134 0.23760073124365214 0.11266906789801506 0.029447341408749796 validation loss: 0.24609080572197908 0.24512481435807082 0.09659937910137385 0.02315569124680801
epoch 12 time used: 42  seconds  train loss: 0.237857263045529 0.23685015545101637 0.10071079051094482 0.02918003330230924 validation loss: 0.2523273694471721 0.25134291771119527 0.0984449523491581 0.02471483178763059
epoch 13 time used: 41  seconds  train loss: 0.23587096074596903 0.23478687092344178 0.10840895310814556 0.027335016007626743 validation loss: 0.2444335082021073 0.24319569428471755 0.12378149759160341 0.026928735348212458
epoch 14 time used: 42  seconds  train loss: 0.23320896698865162 0.23202626713637023 0.11826995693837564 0.035383555440080545 validation loss: 0.25766577780681804 0.25657668870730993 0.10890884303698574 0.03823698908199359
epoch 15 time used: 41  seconds  train loss: 0.23540160128625057 0.2343613056401406 0.10402957577832007 0.04740410890263756 validation loss: 0.2572853536544925 0.25626985350664516 0.1015499772316348 0.046798220395389264
epoch 16 time used: 42  seconds  train loss: 0.23762046397627556 0.23614457539470837 0.14758886173078417 0.049358530411057464 validation loss: 0.24807520571851382 0.2457553600699362 0.23198449076527228 0.046691039131723185
epoch 17 time used: 41  seconds  train loss: 0.23449832991911337 0.23243716753721785 0.20611634558310193 0.050362235707063746 validation loss: 0.2588030037523186 0.25698627455391154 0.1816729191271928 0.04658012328574257
epoch 18 time used: 42  seconds  train loss: 0.23435401420523833 0.23257093096230513 0.17830835766535466 0.04771839929519629 validation loss: 0.2542488955494261 0.25243454159176265 0.18143529273297665 0.04417396946109994
epoch 19 time used: 50  seconds  train loss: 0.23389176630651534 0.23232202138444788 0.15697454021199733 0.047911528544249855 validation loss: 0.24900525041740307 0.2474272543583473 0.15779949508009167 0.04391825489427922
epoch 20 time used: 48  seconds  train loss: 0.22708711036305299 0.22562337763453014 0.14637326650830332 0.044560968762427544 validation loss: 0.23537647665417108 0.23420985755694174 0.11666200968035817 0.041033748538389696
epoch 21 time used: 48  seconds  train loss: 0.2255948750025002 0.22452660828593815 0.10682661946950127 0.04742197127655852 validation loss: 0.233973493014809 0.2328149400009726 0.11585529058519071 0.04007880227191605
epoch 22 time used: 48  seconds  train loss: 0.22007548231755078 0.21918865382755906 0.08868291810471353 0.038454148816822534 validation loss: 0.2306168981842751 0.2296532995335377 0.09635991388537588 0.039091166887078845
epoch 23 time used: 48  seconds  train loss: 0.2172280026208803 0.21617728502218533 0.10507177762465576 0.03701002253476319 validation loss: 0.23240955650371356 0.2312918573356893 0.11176989687837824 0.042448506980699345
epoch 24 time used: 48  seconds  train loss: 0.21288988201090708 0.2116103528409474 0.12795296380261145 0.04369092005452215 validation loss: 0.23791396215884356 0.23627960804170065 0.1634353603455272 0.05384923656600235
epoch 25 time used: 48  seconds  train loss: 0.2130236207240265 0.21180459746140612 0.12190229063888203 0.05885565339290502 validation loss: 0.2284907691365611 0.22711645810273443 0.13743099840888143 0.057746465656444104
epoch 26 time used: 48  seconds  train loss: 0.206941959346319 0.20559224360149014 0.13497154583379012 0.06032438184435752 validation loss: 0.2249609529537006 0.22344964678705173 0.15113062831172108 0.058004599236441357
epoch 27 time used: 48  seconds  train loss: 0.20457379593484726 0.2032145420443336 0.13592543996237333 0.06631721356688047 validation loss: 0.21354044042364526 0.21199953472962343 0.15409053497505884 0.06546225905418396
epoch 28 time used: 48  seconds  train loss: 0.20706022614690497 0.20569324049214466 0.1366985753765156 0.07970943456684534 validation loss: 0.23167618747175175 0.23076237125553353 0.09138175439769335 0.08359382594806435
epoch 29 time used: 48  seconds  train loss: 0.20170066538277912 0.20059878079609905 0.11018842227411631 0.07926808915371153 validation loss: 0.2199836407351668 0.2189053598851183 0.10782823743393821 0.0751761112356708
epoch 30 time used: 48  seconds  train loss: 0.20036050844781364 0.199210790434306 0.11497179077170962 0.0829225310507065 validation loss: 0.21335210031401503 0.21238360736491907 0.0968493093060751 0.07919146943701445
epoch 31 time used: 48  seconds  train loss: 0.20172014000371638 0.20042112524940928 0.12990148582310138 0.08444053685828261 validation loss: 0.2112327367937478 0.21030370998121525 0.09290261457762579 0.080652845417061
epoch 32 time used: 48  seconds  train loss: 0.20302139799110164 0.2013935919480696 0.16278059219185295 0.08498711695620202 validation loss: 0.2153695178554006 0.21457667287248763 0.0792845273485584 0.07693624959374866
epoch 33 time used: 48  seconds  train loss: 0.1973475364623845 0.1964710613488007 0.08764754375592455 0.07759617500989725 validation loss: 0.21189490508859174 0.2108857811715481 0.10091237595699129 0.07561632051085034
epoch 34 time used: 48  seconds  train loss: 0.1967869748866644 0.1957858524051853 0.10011227731611409 0.08049808711844275 validation loss: 0.20475719210875296 0.2034849837096068 0.12722083993854313 0.0814890303337661
epoch 35 time used: 48  seconds  train loss: 0.1913180285532815 0.19042494702341162 0.08930816905155471 0.08745714572049525 validation loss: 0.21256747036084642 0.2118725160438649 0.06949541429207273 0.08365803118169743
epoch 36 time used: 48  seconds  train loss: 0.1931267940678283 0.19204533988142636 0.10814543669640264 0.08762910265631399 validation loss: 0.2119118373063359 0.2108444342778547 0.10674030039432275 0.08381587445300862
epoch 37 time used: 48  seconds  train loss: 0.19167504156827977 0.19056561792780607 0.11094238462979636 0.08832993555696374 validation loss: 0.20135914298739746 0.20020594086960283 0.11532003197574267 0.08342677437040928
epoch 38 time used: 48  seconds  train loss: 0.19141324927789546 0.19032744936916396 0.10858000806180033 0.08852072081183297 validation loss: 0.20264628400767806 0.20145932863663582 0.118695432787394 0.0875935956596458
epoch 39 time used: 48  seconds  train loss: 0.193021178632854 0.19160325552108287 0.14179229077544364 0.08068341475324063 validation loss: 0.20364890940868072 0.20279436251977934 0.08545454847932298 0.07527888003492007
epoch 40 time used: 48  seconds  train loss: 0.18773376297118186 0.18675531387625025 0.09784489249257045 0.07741118092667282 validation loss: 0.20106940336471057 0.20023673574419787 0.08326674915578243 0.07672286319254089
epoch 41 time used: 48  seconds  train loss: 0.1850458082229594 0.1838386080305231 0.1207200805743842 0.07979442535770308 validation loss: 0.1964429978689138 0.195486683610582 0.09563145512538235 0.079253403316014
epoch 42 time used: 48  seconds  train loss: 0.1896962383164796 0.18850840646300318 0.11878322384795516 0.0806712268305897 validation loss: 0.19640267660583022 0.19504953155552385 0.135314468049655 0.07999801237217702
epoch 43 time used: 48  seconds  train loss: 0.18649085220966716 0.18499786039992544 0.14929922404138152 0.07755896553469915 validation loss: 0.1986659988043082 0.19748486575419016 0.11811329073496979 0.0773782815028281
epoch 44 time used: 49  seconds  train loss: 0.18100510827515948 0.17975534435031043 0.1249764032067895 0.07820140859050363 validation loss: 0.1922636874139744 0.19113209040495602 0.11315963973746683 0.07711630067686095
epoch 45 time used: 48  seconds  train loss: 0.18305278511176973 0.18181162427339484 0.1241161117138326 0.07689000981926267 validation loss: 0.20124585515391216 0.19985870642818673 0.13871494742205542 0.07517974524602403
epoch 46 time used: 48  seconds  train loss: 0.1837108747850168 0.18264789379487534 0.10629810829341443 0.0754208349599434 validation loss: 0.19862744340061272 0.1974921525873407 0.1135290604481732 0.0721070922051903
epoch 47 time used: 48  seconds  train loss: 0.18605073606337785 0.18444607424728066 0.16046617074080693 0.07724439417219485 validation loss: 0.20969200084244247 0.20858472524333174 0.11072754896252694 0.07512796599934571
epoch 48 time used: 48  seconds  train loss: 0.18115935693125268 0.18004759061363373 0.11117667407313407 0.07207576177522837 validation loss: 0.19998477100455847 0.19897928799590925 0.10054821583258845 0.06989309458619487
epoch 49 time used: 48  seconds  train loss: 0.18047199624976526 0.17959470975617353 0.08772861040223151 0.0681632886668276 validation loss: 0.1967771625562306 0.19581986823221192 0.09572935605136147 0.07099821949744746
epoch 50 time used: 48  seconds  train loss: 0.17996527455074776 0.17886593237545997 0.10993421420773904 0.06778208146777787 validation loss: 0.19467289328140064 0.19362189542638125 0.10509985976628143 0.06527189093240857
epoch 51 time used: 48  seconds  train loss: 0.17761077430859104 0.17655165414845195 0.10591203225635508 0.06564146586344087 validation loss: 0.19288366888561387 0.19179008482581508 0.10935841585815388 0.06576464045765626
epoch 52 time used: 48  seconds  train loss: 0.1770682849176158 0.1758999710625067 0.11683140805008922 0.0637747717625649 validation loss: 0.19422356123906853 0.1929670068599882 0.12565546303117361 0.06265598724684576
epoch 53 time used: 48  seconds  train loss: 0.18101612171102632 0.17939410206696543 0.16220194473225422 0.06408298397604205 validation loss: 0.2051098817891448 0.20356636494615651 0.15435179038204416 0.06403672359394331
Early stopping at epoch: 54 
trainval loss, loss1, loss2, loss3 0.18673166384172674 0.18508324433506218 0.1648419838728605 0.060730922919599264
YS.shape, YS_pred.shape, (27394, 12, 207, 1) (27394, 12, 207, 1)
YS.shape, YS_pred.shape, (27394, 12, 207) (27394, 12, 207)
**************************************** 
MMGCRN, train, Torch MSE, 0.182882, 0.181721, 0.116108, 0.058958 
MMGCRN, train, MSE, RMSE, MAE, MAPE, 35.254521, 5.937552, 2.867476, 6.801063 
Model Training Ended ... Fri Feb  4 22:30:45 2022
metrla testing started Fri Feb  4 22:30:46 2022
TEST XS.shape, YS.shape, XCov.shape, YCov.shape (6844, 12, 207, 1) (6844, 12, 207, 1) (6844, 12, 207, 1) (6844, 12, 207, 1)
Model Testing Started ... Fri Feb  4 22:30:46 2022
TIMESTEP_IN, TIMESTEP_OUT 12 12
test loss, loss1, loss2, loss3 0.20836070210420898 0.20711293779117612 0.12477645146905993 0.07727866551023976
YS.shape, YS_pred.shape, (6844, 12, 207, 1) (6844, 12, 207, 1)
YS.shape, YS_pred.shape, (6844, 207, 12) (6844, 207, 12)
MMGCRN, test, Torch MSE, 0.208361, 0.207113, 0.124776, 0.077279 
all pred steps, MMGCRN, test, MSE, RMSE, MAE, MAPE, 46.958372, 6.852618, 3.228802, 7.948826 
1 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 28.701308, 5.357360, 2.618676, 6.220074 
2 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 31.154758, 5.581645, 2.791203, 6.970616 
3 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 33.078579, 5.751398, 2.865832, 7.129577 
4 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 33.826555, 5.816060, 2.898794, 7.118689 
5 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 36.408161, 6.033918, 2.949204, 7.225277 
6 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 39.951834, 6.320746, 3.044852, 7.445130 
7 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 44.433202, 6.665823, 3.167397, 7.735141 
8 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 49.684189, 7.048701, 3.312916, 8.088925 
9 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 55.817239, 7.471094, 3.480151, 8.527042 
10 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 62.732973, 7.920415, 3.668078, 9.050564 
11 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 70.162924, 8.376331, 3.873157, 9.642760 
12 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 77.551758, 8.806348, 4.075451, 10.232334 
Model Testing Ended ... Fri Feb  4 22:30:54 2022
