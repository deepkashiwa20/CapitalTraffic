lamb 0.01
lamb1 0.01
experiment_city tokyo
experiment_month 202112
model_name MMGCRN
memory_type local
mem_num 10
mem_dim 32
meta_type yes
decoder_type stepwise
go_type random
ycov_type time
batch_size 64
rnn_units 32
num_layers 1
channnel_in 1
channnel_out 1
feature_time True
feature_history False
train_data (4464, 1843, 2)
train_data (4320, 1843, 2)
test_data (4464, 1843, 2)
tokyo 202112 training started Tue Feb  8 04:45:09 2022
TRAIN XS.shape YS.shape, XCov.shape, YCov.shape (8762, 6, 1843, 1) (8762, 6, 1843, 1) (8762, 6, 1843, 1) (8762, 6, 1843, 1)
Model Training Started ... Tue Feb  8 04:45:12 2022
TIMESTEP_IN, TIMESTEP_OUT 6 6
Trainable parameter list: 

 In total: 64217 trainable parameters. 
 
XS_torch.shape:   torch.Size([8762, 6, 1843, 1])
YS_torch.shape:   torch.Size([8762, 6, 1843, 1])
YCov_torch.shape:   torch.Size([8762, 6, 1843, 1])
epoch 0 time used: 40  seconds  train loss: 0.6242282944461415 0.6088433902642078 1.4534933362227018 0.08499738770298826 validation loss: 0.5861182460932903 0.5804732327372013 0.5150844735921871 0.04941746904351079
epoch 1 time used: 39  seconds  train loss: 0.5560239579575625 0.5538346454752868 0.1827209264362009 0.03621056186651244 validation loss: 0.5670070046434006 0.5661309348671799 0.053430483927707974 0.03417652677948659
epoch 2 time used: 40  seconds  train loss: 0.5526356952155205 0.552183272631414 0.019895017625835728 0.02534744171662393 validation loss: 0.5625823001266342 0.5621308713593695 0.017992555122728585 0.027149443317413847
epoch 3 time used: 40  seconds  train loss: 0.546463661098785 0.5461287997915871 0.01123308923788252 0.022252885517333308 validation loss: 0.5560492176761479 0.555679757523787 0.011812688387711058 0.02513295247094958
epoch 4 time used: 40  seconds  train loss: 0.5406990459186268 0.5404174146795904 0.007272195284182707 0.020890875833015195 validation loss: 0.552984468513077 0.5526695548535917 0.007958251958114015 0.023533050096685187
epoch 5 time used: 40  seconds  train loss: 0.5381386182003779 0.5378939482904863 0.004469231342422867 0.01999749947980493 validation loss: 0.5515180191782608 0.5512110675948224 0.0074834697108353615 0.023211843875249136
epoch 6 time used: 40  seconds  train loss: 0.5344399729832324 0.5341866527531104 0.004236807230037381 0.021094989850198708 validation loss: 0.5522730829562297 0.5517088924842792 0.0275877238088043 0.028831545320912918
epoch 7 time used: 40  seconds  train loss: 0.5174340941992693 0.5168231187790537 0.028688618514741814 0.032408652446450865 validation loss: 0.5189856020950498 0.5183377673858814 0.024905654650688638 0.03987706313101003
epoch 8 time used: 40  seconds  train loss: 0.5081368648485223 0.5074097411379642 0.03435170388220834 0.0383606188122839 validation loss: 0.5087028523385932 0.5077949480507702 0.045905587297942044 0.044884193663977154
epoch 9 time used: 40  seconds  train loss: 0.4926291249818298 0.49205197194561967 0.015087107209347868 0.04262819059228284 validation loss: 0.4956706978452091 0.4949916355390083 0.021604863838035494 0.04630124353345046
epoch 10 time used: 40  seconds  train loss: 0.4837535394415466 0.4831136812033165 0.02246022961944174 0.041525806546247525 validation loss: 0.4888754744934524 0.4882299791781775 0.02198850703955977 0.04256100412364667
epoch 11 time used: 40  seconds  train loss: 0.4777654609239695 0.47727838616686097 0.010325374675022016 0.03838211826310004 validation loss: 0.485213770544295 0.4847461626525341 0.007563679329013781 0.03919711458317796
epoch 12 time used: 40  seconds  train loss: 0.4732170667147241 0.4727844760817419 0.006931422133222075 0.03632779331831623 validation loss: 0.48124547240833127 0.480780909617488 0.00827922608444396 0.03817729221504745
epoch 13 time used: 40  seconds  train loss: 0.46960173733900934 0.4691378332276519 0.010942382907576823 0.03544802738209327 validation loss: 0.4781819324088608 0.47765170133641627 0.015335867192472078 0.037687660297374644
epoch 14 time used: 40  seconds  train loss: 0.4680735882495822 0.46750297332858587 0.021867288092868167 0.03519432779711651 validation loss: 0.47758649741879666 0.47704763968259656 0.01751656063223646 0.03636913877006047
epoch 15 time used: 40  seconds  train loss: 0.46479741134358366 0.4641852920058292 0.027086180969284716 0.034125742180636624 validation loss: 0.4718584620424843 0.47138474619807524 0.012202519605604449 0.035169298026501615
epoch 16 time used: 40  seconds  train loss: 0.4619668557335118 0.4614534870781069 0.017590874698613444 0.03374612305595112 validation loss: 0.47218066881041393 0.4717246189965118 0.010622632234420632 0.034982505671438534
epoch 17 time used: 41  seconds  train loss: 0.4611329642755041 0.46067292564464224 0.012237511012403274 0.0337662279306527 validation loss: 0.4703187635368215 0.4698648528386773 0.010788819823726087 0.03460227796363265
epoch 18 time used: 41  seconds  train loss: 0.46376502202754877 0.46331223505324487 0.011038468564174397 0.034240135245264404 validation loss: 0.47149010244051326 0.47101169978304575 0.012323368655918111 0.03551677745456214
epoch 19 time used: 41  seconds  train loss: 0.45421082379610783 0.45378460022906447 0.00768760233226579 0.034934986919604595 validation loss: 0.46206337935790687 0.4615794865712898 0.012071416829792389 0.03631775596084278
epoch 20 time used: 40  seconds  train loss: 0.449374701185434 0.44896387406687926 0.0061191403029367195 0.03496352447900684 validation loss: 0.4668358140397649 0.46623932625647824 0.02200329134411889 0.03764551759891753
epoch 21 time used: 40  seconds  train loss: 0.4463452214275642 0.4459446475143357 0.004927650628646312 0.035129820419158804 validation loss: 0.4613699508088737 0.4608607444655455 0.013753328080304368 0.03716715640081956
epoch 22 time used: 41  seconds  train loss: 0.4431569966900169 0.4427667148190172 0.004003746519376881 0.03502442548795571 validation loss: 0.4592014242529815 0.45874362526991114 0.009015699743062839 0.036764201209533984
epoch 23 time used: 40  seconds  train loss: 0.4408759440920012 0.44049364766053567 0.0033010415091663894 0.034928486381577056 validation loss: 0.4599366862716222 0.4594999624680624 0.007185568927184924 0.03648686094531753
epoch 24 time used: 40  seconds  train loss: 0.4396216454362238 0.43924218904226453 0.003104616316119579 0.03484110180880994 validation loss: 0.4523617016268016 0.4519117261274173 0.00841837582917606 0.03657946073535587
epoch 25 time used: 40  seconds  train loss: 0.436498611702837 0.4361195586266864 0.003082418191388279 0.03482292194654727 validation loss: 0.44616422319673393 0.44574534108191527 0.005759049270732225 0.03612950517758149
epoch 26 time used: 40  seconds  train loss: 0.43448937493015727 0.43411166033703447 0.0031776914103819804 0.034593954245247915 validation loss: 0.44355889569945883 0.44313454377711065 0.006364586751288316 0.03607040469924482
epoch 27 time used: 40  seconds  train loss: 0.4339402681515653 0.43355699730525366 0.0038257991590213555 0.03450127182325133 validation loss: 0.4425774464619209 0.4421052867448912 0.01087568053658601 0.036340438313221125
epoch 28 time used: 40  seconds  train loss: 0.43285481996177777 0.43246128448538723 0.00467496180957632 0.034678528538610705 validation loss: 0.44035384314672854 0.4398898951733074 0.010404580999599343 0.03598982445208763
epoch 29 time used: 40  seconds  train loss: 0.4276887737549053 0.427302644516195 0.00410660760347642 0.03450635854529565 validation loss: 0.4380047841738044 0.4375665201709892 0.007751836272811798 0.036074534054320186
epoch 30 time used: 40  seconds  train loss: 0.42607486352784835 0.4256919537336564 0.0039987112286863045 0.03429234654205681 validation loss: 0.43622562176340085 0.43581407119671756 0.005456705185600027 0.03569830351669404
epoch 31 time used: 40  seconds  train loss: 0.4242163106941992 0.42384592798035214 0.003028215444813311 0.03401012234180018 validation loss: 0.4339188893654204 0.43351856716035003 0.004480845672326032 0.03555113096036687
epoch 32 time used: 40  seconds  train loss: 0.42227802133200976 0.4219115888205244 0.002629929367034608 0.034013179566962336 validation loss: 0.4317465425625831 0.4313464664613096 0.004353622434590019 0.03565422352190869
epoch 33 time used: 40  seconds  train loss: 0.4209569846589604 0.42058816440137003 0.002678321256364872 0.03420360760941587 validation loss: 0.43066817815855507 0.43026696693021266 0.00424305356049418 0.03587779554566908
epoch 34 time used: 40  seconds  train loss: 0.4193055711458706 0.41893387987831016 0.0027350497048242175 0.03443407328787178 validation loss: 0.4300908912185772 0.4296829017369729 0.004592467720026515 0.036206318329916
epoch 35 time used: 40  seconds  train loss: 0.4175279298713628 0.41715027075564187 0.0030294288318623223 0.034736480309327904 validation loss: 0.4298960715464292 0.4294786609263792 0.005158989839442839 0.0365821477238281
epoch 36 time used: 40  seconds  train loss: 0.4157692716421375 0.4153852155946593 0.0033448504281827387 0.035060536543826064 validation loss: 0.4288383071714207 0.4284112983944752 0.005716473714285711 0.03698427633253584
epoch 37 time used: 40  seconds  train loss: 0.41412051168773983 0.413730517862014 0.003591723909470892 0.03540766948394408 validation loss: 0.42720857312939364 0.4267726059321234 0.0062115458267456534 0.03738492321510366
epoch 38 time used: 40  seconds  train loss: 0.4124663016001867 0.4120730094361062 0.0035708163242139123 0.03575841069171607 validation loss: 0.4255165947403118 0.4250774718838051 0.006135867045760074 0.037776138094504204
epoch 39 time used: 40  seconds  train loss: 0.4107959629003179 0.4104015297758001 0.003336682496160119 0.03610688187051556 validation loss: 0.42374043035376624 0.4233010647123886 0.005761930294840612 0.03817518840028319
epoch 40 time used: 40  seconds  train loss: 0.40941052575794246 0.4090147844198686 0.00311001692441485 0.03646414150689276 validation loss: 0.4224578955166963 0.4220157601500363 0.005568804601447539 0.03864478006608706
epoch 41 time used: 40  seconds  train loss: 0.4075117317885682 0.40711456535886076 0.002858092508403086 0.03685854094108931 validation loss: 0.4215853462911316 0.42114409503736544 0.004986826842576384 0.039138286577266465
epoch 42 time used: 40  seconds  train loss: 0.4063783261741864 0.40597885875211354 0.002695201696288575 0.03725131688232183 validation loss: 0.4208145466285011 0.42036611660600853 0.005144228264204869 0.039698489454104334
epoch 43 time used: 40  seconds  train loss: 0.40392088669200155 0.4035174226247453 0.002569956165966451 0.03777660649049284 validation loss: 0.4203138604848584 0.4198673952937072 0.004354424696593766 0.04029226569022723
epoch 44 time used: 40  seconds  train loss: 0.40386626678611787 0.4034588576188608 0.002533271541336945 0.038207800258101256 validation loss: 0.41929493110672844 0.4188440000015217 0.004348615875585827 0.04074493879116545
epoch 45 time used: 40  seconds  train loss: 0.40106856016567755 0.40065429002849356 0.0027458002383895404 0.03868120993833222 validation loss: 0.4172678454615438 0.4168177930827774 0.0038523418159735873 0.04115269129601911
epoch 46 time used: 40  seconds  train loss: 0.40065906053172856 0.4002399289241539 0.0028391181741968838 0.039073995374491216 validation loss: 0.41258690599054576 0.4121351150250881 0.003479022527972618 0.041699821863107514
epoch 47 time used: 40  seconds  train loss: 0.39893940918849424 0.398508002702331 0.003462182935320028 0.03967842796491154 validation loss: 0.41103238751495447 0.41057397208220336 0.0035908440993140255 0.04225090360298705
epoch 48 time used: 40  seconds  train loss: 0.39993046460186504 0.39949917967434506 0.0031017471377243104 0.04002670010345165 validation loss: 0.4121985284093851 0.41172340923060785 0.0043093018723241155 0.043202366253139224
epoch 49 time used: 40  seconds  train loss: 0.3961191629142526 0.39567747622333765 0.0034159033664250913 0.04075285373163485 validation loss: 0.40997152314072927 0.4095012252323163 0.003501305708258712 0.043528416962968546
epoch 50 time used: 40  seconds  train loss: 0.3935715424889318 0.39312179465305497 0.003313236794596293 0.04166145867360108 validation loss: 0.4109170719783962 0.4104418588767363 0.0032021872792669264 0.04431907262692219
epoch 51 time used: 40  seconds  train loss: 0.39279456352955344 0.39234102182311387 0.003018677946754528 0.04233549447230436 validation loss: 0.40828072326959186 0.40780120864952607 0.003084400027154234 0.04486698344084619
epoch 52 time used: 40  seconds  train loss: 0.3907710509410171 0.39030230325154747 0.003495621637584651 0.04337909417727225 validation loss: 0.41035914755694564 0.40986724431141497 0.0029728596801357364 0.04621767620791969
epoch 53 time used: 40  seconds  train loss: 0.3889009468523884 0.3884210665192239 0.0034414413737917917 0.04454692141278351 validation loss: 0.40905237199236194 0.40855077771441894 0.003028503445388145 0.04713086004652481
epoch 54 time used: 40  seconds  train loss: 0.3880440478971824 0.38755721140898375 0.003207124423976135 0.045476652786709405 validation loss: 0.4086411030583053 0.40812917246169994 0.003262906206605105 0.04793043102217232
epoch 55 time used: 40  seconds  train loss: 0.386158891504095 0.3856515792375503 0.003779926620137282 0.04695147836504054 validation loss: 0.410829555112333 0.4102963649998077 0.003831675538426798 0.04948736342126678
epoch 56 time used: 40  seconds  train loss: 0.3859319030567312 0.38540949296813415 0.0041405400067109745 0.04810056851003526 validation loss: 0.4109812628346891 0.4104401128224617 0.003820745478031816 0.05029428545904181
epoch 57 time used: 40  seconds  train loss: 0.3840719290001718 0.38353931164563726 0.004153255167293708 0.04910847507876415 validation loss: 0.4109418854926722 0.4103732996882504 0.004907577999942736 0.05195113497440644
epoch 58 time used: 40  seconds  train loss: 0.3835400227333127 0.3829838630634616 0.005010037403649394 0.05060615617480838 validation loss: 0.4109805068677008 0.4103861079402081 0.005872036444426215 0.05356809644122909
epoch 59 time used: 40  seconds  train loss: 0.3823593140256185 0.38178585635039236 0.005491813580898715 0.051853902483186914 validation loss: 0.40448243402553336 0.4038740045155961 0.0060966221288582785 0.05474589559169242
epoch 60 time used: 40  seconds  train loss: 0.3800684868962847 0.37947294391774455 0.006363033622710493 0.05319116408128097 validation loss: 0.40012217276665457 0.3994837268500065 0.007838091783485678 0.056006861781758406
epoch 61 time used: 40  seconds  train loss: 0.37750041961053105 0.37686911485199154 0.008436372018630529 0.05469419396795778 validation loss: 0.39595290142507217 0.3952783021492699 0.009800583328777564 0.057659336857562304
epoch 62 time used: 40  seconds  train loss: 0.3770855994479258 0.37642661032747815 0.009778240230430517 0.05612059751546214 validation loss: 0.3957407728742106 0.3950475125022263 0.010543772343931689 0.05878235011041464
epoch 63 time used: 40  seconds  train loss: 0.37795183365973795 0.3772849364334037 0.00991240843334406 0.056777250965065904 validation loss: 0.390779692076048 0.39006403940064566 0.012673106465985151 0.05889260650041549
epoch 64 time used: 40  seconds  train loss: 0.3756262686195992 0.37491500000760647 0.01305302938543064 0.05807390846533148 validation loss: 0.38934461692869254 0.38857700653622435 0.01611237889789096 0.06064835477268408
epoch 65 time used: 40  seconds  train loss: 0.3753103630634552 0.37458164245457143 0.01355275113984269 0.0593193915002632 validation loss: 0.3831897469918405 0.3823920575819403 0.018400956117936986 0.06136774232280358
epoch 66 time used: 40  seconds  train loss: 0.3713713702528177 0.37060910552227594 0.015612224520433123 0.06061431868680716 validation loss: 0.38334254726651923 0.38254410773855757 0.016907494684569927 0.06293653058154243
epoch 67 time used: 40  seconds  train loss: 0.3703224773939261 0.36955211633254254 0.015335389180782134 0.061700650998363575 validation loss: 0.3872253210209429 0.3864255725983777 0.01613061034427943 0.06384450338342211
epoch 68 time used: 40  seconds  train loss: 0.37008953915849124 0.36931754625781527 0.014735344064758849 0.0624639440541615 validation loss: 0.38067539695298386 0.3798736591063804 0.016001502036434544 0.06417215545629867
epoch 69 time used: 40  seconds  train loss: 0.36837019520414743 0.3675772130008594 0.015723546287020787 0.06357472249281368 validation loss: 0.37927246986051394 0.3784765753774325 0.014891295920375655 0.06469817672797068
epoch 70 time used: 40  seconds  train loss: 0.36808158785417694 0.3672999684223935 0.014373198282265569 0.06378877553434029 validation loss: 0.37491880027413205 0.3740739619579559 0.01909932446768503 0.0653841456373714
epoch 71 time used: 40  seconds  train loss: 0.36626624527214835 0.36546360284402984 0.015173499081825225 0.06509081779404728 validation loss: 0.37177587224707 0.3709085904153609 0.020041339152115548 0.06668657641849361
epoch 72 time used: 40  seconds  train loss: 0.3621636597583363 0.3612894905228499 0.020558069240834195 0.06685878096845412 validation loss: 0.369162726094874 0.36822298218103805 0.024752122409546527 0.0692223526200765
epoch 73 time used: 40  seconds  train loss: 0.3606638436746677 0.35971842505510604 0.02571641324773111 0.06882561581117742 validation loss: 0.37579066743321854 0.37481126707473994 0.02753052553939852 0.07040957136684114
epoch 74 time used: 40  seconds  train loss: 0.36316600208811484 0.36228144647341814 0.0202532478841624 0.06820233721921586 validation loss: 0.3802346357576709 0.37929791625587433 0.024675798808984944 0.06899629286411743
epoch 75 time used: 40  seconds  train loss: 0.362745143451605 0.36181494377733747 0.025169962411058983 0.06785008073955198 validation loss: 0.36793466352371795 0.36686996343689715 0.0372890389466166 0.06918082337627558
epoch 76 time used: 40  seconds  train loss: 0.3592967381308275 0.35807272895723874 0.05310276219131758 0.06929807950918432 validation loss: 0.36604714491551243 0.36443402300899513 0.09047042521669788 0.07084198840496367
epoch 77 time used: 40  seconds  train loss: 0.3572715634834166 0.35517145422763646 0.14036251552399573 0.06964849820466841 validation loss: 0.36711263210465517 0.3645501297693283 0.18646939761259956 0.06978088964519845
epoch 78 time used: 40  seconds  train loss: 0.35608119617911205 0.35397651816517445 0.14216846744571715 0.06829956069241701 validation loss: 0.3683761899218827 0.36651950497868835 0.11733713834144818 0.06833146179935694
epoch 79 time used: 40  seconds  train loss: 0.3548202623544155 0.3532698663823809 0.0881057684472064 0.06693395604881916 validation loss: 0.36538963852979883 0.36420671752684197 0.051791413078048035 0.06650070297573865
epoch 80 time used: 40  seconds  train loss: 0.3525228289015089 0.35141243825871693 0.04483986517244089 0.06619910846501612 validation loss: 0.3609400847250879 0.3599578649390511 0.031791730483357136 0.06643022515903266
epoch 81 time used: 40  seconds  train loss: 0.34751988197911404 0.34651698229012107 0.03348991891085475 0.06679994101675656 validation loss: 0.3570278042503167 0.35610183515759813 0.025111694326296972 0.0674852341420299
epoch 82 time used: 40  seconds  train loss: 0.34298961912908976 0.3420133449011353 0.030031995700136236 0.06759551910731985 validation loss: 0.3518343302742198 0.35091541757163586 0.023522804220028934 0.06836889747110256
epoch 83 time used: 40  seconds  train loss: 0.3385733385061387 0.33762804903299765 0.02649629157444165 0.06803286119472343 validation loss: 0.35271235742780077 0.35181883703840755 0.020532067717209845 0.0688198076255895
epoch 84 time used: 40  seconds  train loss: 0.33400137777597716 0.33308747634824565 0.02286220374405883 0.06852809458363275 validation loss: 0.3504131019033835 0.3495310787086017 0.019112353703659154 0.06908993348513276
epoch 85 time used: 40  seconds  train loss: 0.3307042513975286 0.3298241445062513 0.019026402957774864 0.06898437328596961 validation loss: 0.3464916902609146 0.34561244213706227 0.0186057270894321 0.06931912867052269
epoch 86 time used: 40  seconds  train loss: 0.3278985752024946 0.3270402970043351 0.016331900636267396 0.06949573311018736 validation loss: 0.34262298823545534 0.3417661999361203 0.015346157465288215 0.07033258677209038
epoch 87 time used: 40  seconds  train loss: 0.3249152619859396 0.3240684247954834 0.014567066332955481 0.07011648714474357 validation loss: 0.3436771284929969 0.34282751001217004 0.013876166742164107 0.07108561544318223
epoch 88 time used: 40  seconds  train loss: 0.32198969797807964 0.3211464031503509 0.013362079765236626 0.07096758399801047 validation loss: 0.3396712037076258 0.3388105216144917 0.014164202758810295 0.07190412158824058
epoch 89 time used: 40  seconds  train loss: 0.32016496074343 0.3193242232098534 0.012370219700358181 0.07170363593738276 validation loss: 0.344937582652028 0.3440874904489365 0.01226110358534203 0.0727480523686113
epoch 90 time used: 40  seconds  train loss: 0.31767640340057907 0.3168271616103533 0.012083992437140489 0.07284059948349558 validation loss: 0.33613895668062865 0.33526786318493457 0.012425063738394537 0.07468402680198333
epoch 91 time used: 40  seconds  train loss: 0.3209444962939685 0.3200701587984976 0.013591772533829599 0.07384183433452819 validation loss: 0.34515722937259646 0.34429192253303875 0.011217487670331582 0.07531349539811183
epoch 92 time used: 40  seconds  train loss: 0.3157917548579325 0.31493053071993415 0.011070301160987355 0.07505197685964211 validation loss: 0.3422538348116977 0.3413755790194873 0.011842556874595483 0.07598309445699455
epoch 93 time used: 40  seconds  train loss: 0.3136622739144791 0.3127949474210192 0.010967596508182723 0.07576535603822665 validation loss: 0.33863256548649096 0.33773190999129005 0.013096701550169494 0.07696869282119082
epoch 94 time used: 40  seconds  train loss: 0.3123179137697686 0.31143881241093485 0.011349787301504526 0.07656027871353988 validation loss: 0.33501098805886326 0.33410479470454957 0.012989903018065562 0.07762961284121875
epoch 95 time used: 40  seconds  train loss: 0.3124347726352827 0.3115453682539398 0.011723111866782144 0.07721737904887714 validation loss: 0.3482613193967037 0.347328768683481 0.014926939633122758 0.07832807566696844
epoch 96 time used: 40  seconds  train loss: 0.3103496042347956 0.3094529488273197 0.011583622831303023 0.07808205391800652 validation loss: 0.33206337339417785 0.331120436306361 0.014927832695809825 0.07936595663571129
epoch 97 time used: 40  seconds  train loss: 0.3085572938680685 0.3076534012040307 0.01140367809902486 0.07898568928473036 validation loss: 0.346687532434285 0.3457310389895681 0.015265724762835524 0.08038379297864214
epoch 98 time used: 40  seconds  train loss: 0.30835854491039494 0.3074488584045732 0.011427115055693736 0.07954136364296897 validation loss: 0.33393135749820374 0.33297502193370404 0.014842539498627539 0.08079114688593522
epoch 99 time used: 40  seconds  train loss: 0.30627913045349814 0.30536858557185304 0.011020148039746278 0.08003428658880685 validation loss: 0.33395305448664425 0.33299311663613695 0.014263669727263876 0.08173022495046264
epoch 100 time used: 40  seconds  train loss: 0.3058559069612077 0.3049396023079424 0.011322472017162594 0.08030783047942407 validation loss: 0.3382089060770763 0.33723191577568823 0.015429580135509841 0.08226918424715576
epoch 101 time used: 40  seconds  train loss: 0.30535345866407654 0.3044328481217458 0.011603601935929476 0.08045756578413686 validation loss: 0.338448324006532 0.33744230886835425 0.01807508664354444 0.0825263265739669
epoch 102 time used: 40  seconds  train loss: 0.30387950633835203 0.30295302776817934 0.011595914185981448 0.08105181718395102 validation loss: 0.33235194793524453 0.33136215321770657 0.016319449950181312 0.08266010056179661
epoch 103 time used: 40  seconds  train loss: 0.30182054244733586 0.3008955070833114 0.01104701613561464 0.08145668154763515 validation loss: 0.3419815885563628 0.34096733121935063 0.018241301636729733 0.08318452561543664
epoch 104 time used: 40  seconds  train loss: 0.30197059435580276 0.30103754734198374 0.01149189965483388 0.0818130256169609 validation loss: 0.3285951252698572 0.3275914670315468 0.016959340050170434 0.08340655233573283
epoch 105 time used: 40  seconds  train loss: 0.29936446507324316 0.2984334976138671 0.010855989223123594 0.08224061614500844 validation loss: 0.324600978427584 0.32358523797956246 0.01787839882481301 0.08369514587561
epoch 106 time used: 40  seconds  train loss: 0.29883930229048555 0.2979049908799172 0.010940251775849013 0.08249084191464014 validation loss: 0.33506748073452525 0.33404753377915297 0.017849626651247143 0.08414516976466194
epoch 107 time used: 40  seconds  train loss: 0.30006878118122426 0.2991143977364491 0.012588431152739476 0.08284993555888323 validation loss: 0.31839685537182866 0.3173674135135222 0.018849122549255436 0.08409514412834784
epoch 108 time used: 40  seconds  train loss: 0.29753693403981446 0.29657320395449926 0.013113304636034542 0.0832594095846504 validation loss: 0.32611967066225533 0.3251058874011638 0.016625081989378593 0.08475294939082054
epoch 109 time used: 40  seconds  train loss: 0.295778048199944 0.2948152644778292 0.01264460518527586 0.08363384824898704 validation loss: 0.3329142384989411 0.3319100531907127 0.015304909320866977 0.08511389542705988
epoch 110 time used: 40  seconds  train loss: 0.3001281602200154 0.29913311372190066 0.015737465380536077 0.08376707255912869 validation loss: 0.3218282641122897 0.3207739713337801 0.020286696656113587 0.08514220802439015
epoch 111 time used: 40  seconds  train loss: 0.3004297864498785 0.29941559619345526 0.017091351469405807 0.08432783548363157 validation loss: 0.3207000717758752 0.3196605770270175 0.01830364612157706 0.08564592248049026
epoch 112 time used: 40  seconds  train loss: 0.29706189884948614 0.2960819245346277 0.013702750629206133 0.08429489975386678 validation loss: 0.3198974097444281 0.3188468918768797 0.019867793567196413 0.08518361013904656
epoch 113 time used: 40  seconds  train loss: 0.2947709998335582 0.29378027048145067 0.014349528594732538 0.08472326523413888 validation loss: 0.3172357009051326 0.3161787429203023 0.019674610219035504 0.08602100155060828
epoch 114 time used: 40  seconds  train loss: 0.29531373688844836 0.2943124824999094 0.015096005563131117 0.08502943163760049 validation loss: 0.31700084112594795 0.3159814063189292 0.01653705126449078 0.08540642563132922
epoch 115 time used: 40  seconds  train loss: 0.29466307579591167 0.2936622951740436 0.01474708005538761 0.08533070285313751 validation loss: 0.3159614264121724 0.3149215375544654 0.018072981605011272 0.08591591594005382
epoch 116 time used: 40  seconds  train loss: 0.2935871659502956 0.2926008591567013 0.013035638909829459 0.08559512636797048 validation loss: 0.3141224197958333 0.3130747632232772 0.018139817889240822 0.08662562411310791
epoch 117 time used: 40  seconds  train loss: 0.2922200701712401 0.2912246288320387 0.013664064313204407 0.08588027020936469 validation loss: 0.31131835614421605 0.3102701628850182 0.017755277221066013 0.08706441908625913
epoch 118 time used: 40  seconds  train loss: 0.2922513473344129 0.2912500723141946 0.013961509590833277 0.08616595846358327 validation loss: 0.31120567516832254 0.3101611721058623 0.01744515474185191 0.08700505207113782
epoch 119 time used: 40  seconds  train loss: 0.29218485704242614 0.29117602580233337 0.01446480559134974 0.0864185056191495 validation loss: 0.31261939808746714 0.311563740468689 0.018521701418023194 0.0870441603013121
epoch 120 time used: 40  seconds  train loss: 0.29232933689172436 0.2913190093582541 0.014258035374151946 0.08677479437661668 validation loss: 0.31880261297097545 0.31773368711615196 0.019266103679549743 0.08762674585209215
epoch 121 time used: 40  seconds  train loss: 0.2947848755653691 0.293779950035052 0.013530778967772711 0.08696188854560734 validation loss: 0.31927940740480865 0.31815707384315817 0.023615092761297713 0.08861856574353319
epoch 122 time used: 40  seconds  train loss: 0.2932927242798124 0.2922756782706117 0.0147489305811544 0.08695563761847075 validation loss: 0.3054069300619558 0.3043453063202035 0.01762137173694979 0.08854137752791727
epoch 123 time used: 40  seconds  train loss: 0.28963622670343453 0.2886225399298313 0.013793157822641131 0.0875756436492043 validation loss: 0.3098203854602203 0.30878496171404163 0.014966426459738296 0.08857604471897763
epoch 124 time used: 40  seconds  train loss: 0.2875517253515801 0.2865420859701066 0.013043453452521614 0.08792038024914099 validation loss: 0.3054070593640446 0.3043866939791693 0.01364817875826375 0.08838828015836174
epoch 125 time used: 40  seconds  train loss: 0.28646691462580354 0.28546510009783044 0.01214772756733743 0.08803369478014865 validation loss: 0.3060834483978466 0.30505691963154014 0.013946828740980053 0.08870583545843361
epoch 126 time used: 40  seconds  train loss: 0.2865165251245819 0.28551509169533706 0.011997023920438308 0.08814627153019694 validation loss: 0.30607778522207657 0.3050439600964106 0.014320999115708891 0.08906164597031299
epoch 127 time used: 40  seconds  train loss: 0.2864581991495598 0.28544695465609354 0.012895348865715717 0.0882291472295143 validation loss: 0.3011821156655855 0.3001454637127889 0.014866299839245707 0.0887991487197765
epoch 128 time used: 40  seconds  train loss: 0.2867571308521752 0.28573598859063787 0.013632891564459185 0.08848142712455673 validation loss: 0.3054894724565791 0.304444724256075 0.015429474975971573 0.0890453984609808
epoch 129 time used: 40  seconds  train loss: 0.2867264225364657 0.2857071921499221 0.01337683948076918 0.08854601512378327 validation loss: 0.30761730453294467 0.30657199165256316 0.015357308551143738 0.08917388351934243
epoch 130 time used: 40  seconds  train loss: 0.2877331807939561 0.2867121310869756 0.013354999809213387 0.08874987449376229 validation loss: 0.30823203314661923 0.3071787050601719 0.0163311791161627 0.08900207250507822
epoch 131 time used: 40  seconds  train loss: 0.28718250599413264 0.28616105099643063 0.01350890965291811 0.08863653913151635 validation loss: 0.31598067857641327 0.3148805052790126 0.019558640607321973 0.09045829297145824
epoch 132 time used: 40  seconds  train loss: 0.2877883085457453 0.28676364279341215 0.013940431320765686 0.0885261603798465 validation loss: 0.303032374760159 0.3019453594669366 0.018223688015752543 0.09047765855727159
epoch 133 time used: 40  seconds  train loss: 0.2848278097485212 0.2838084441925035 0.012860983665428774 0.0890756879319903 validation loss: 0.2982490843341319 0.2971995191071361 0.014150284121041698 0.09080627487503955
epoch 134 time used: 40  seconds  train loss: 0.2832660288448621 0.28225813091499696 0.011532563430511834 0.08925720147891705 validation loss: 0.30048485543019476 0.2994120066593576 0.017038239894068403 0.09024661360117248
epoch 135 time used: 40  seconds  train loss: 0.2805871506873702 0.27957115200915267 0.012388683425234507 0.08921113775584129 validation loss: 0.3009094570881153 0.2998790521564031 0.01268877757803313 0.0903519931883096
epoch 136 time used: 40  seconds  train loss: 0.281726179915174 0.2807238566024611 0.011049916886607886 0.08918254156804596 validation loss: 0.30190700995818714 0.30087720858131245 0.01257055671673076 0.09040941687369662
epoch 137 time used: 40  seconds  train loss: 0.2800702945162147 0.279063201249054 0.011558578200264121 0.08915084313922704 validation loss: 0.2976566896978332 0.2966233462380906 0.012807177948467485 0.09052720964839066
epoch 138 time used: 40  seconds  train loss: 0.2798454942604919 0.278840648390499 0.01123878514045361 0.08924573104873383 validation loss: 0.29610447542735946 0.29507684874948115 0.01234027410299266 0.09042255579405101
epoch 139 time used: 40  seconds  train loss: 0.2793818611683974 0.2783777988804219 0.011211467345431277 0.08919492717580044 validation loss: 0.29733807355886394 0.296312423709428 0.012183104868934055 0.09038184143497431
epoch 140 time used: 40  seconds  train loss: 0.27760400931832635 0.2766024033567202 0.011000950792999951 0.08915947228012483 validation loss: 0.30412885299125036 0.3031018195985823 0.012318723813585158 0.09038448454119309
epoch 141 time used: 40  seconds  train loss: 0.27778459375823694 0.27678225141938756 0.011065143449443163 0.08916904189156317 validation loss: 0.3033802942944574 0.30233714287817504 0.013980508982601338 0.09033456033275096
epoch 142 time used: 40  seconds  train loss: 0.27837422966340275 0.2773669714425873 0.011512986357899116 0.089212968220968 validation loss: 0.29839287148061705 0.29736231266772134 0.012770302858525 0.09028536394503714
epoch 143 time used: 40  seconds  train loss: 0.2769652931517144 0.2759608668635886 0.011109607561508862 0.08933324058285189 validation loss: 0.30764853057933145 0.3066196112750274 0.012263493579997252 0.0906285248298941
epoch 144 time used: 40  seconds  train loss: 0.27681544995474827 0.27581645868771915 0.01063548008272241 0.08926359367681735 validation loss: 0.3003099194567588 0.299284949388639 0.01202956635151305 0.09046754446722285
epoch 145 time used: 40  seconds  train loss: 0.2759816175480626 0.27498543439817075 0.010297413812320962 0.08932091289029385 validation loss: 0.3098245561803002 0.3088060317247331 0.011235677341950547 0.09061679221257833
epoch 146 time used: 40  seconds  train loss: 0.2787392609985864 0.2777314831896326 0.011498645145722157 0.08927893698818697 validation loss: 0.29945140985907187 0.2984315463257184 0.012101977944139447 0.0898840381457402
epoch 147 time used: 40  seconds  train loss: 0.27618335476115385 0.27517836763967285 0.011551095368778564 0.08894762026381046 validation loss: 0.30357034684642165 0.3025514295061992 0.011941528279336007 0.08995034733709817
epoch 148 time used: 40  seconds  train loss: 0.27472668016742413 0.27371936490448295 0.01171472821481188 0.0890167318154118 validation loss: 0.2954153620124897 0.29439580723446074 0.011910905284506989 0.09004454498677861
epoch 149 time used: 40  seconds  train loss: 0.27331099180829815 0.2723091124281856 0.011100054173310078 0.0890879128856794 validation loss: 0.29184485803941024 0.2908271422183769 0.011587789783994733 0.09018439013342616
epoch 150 time used: 40  seconds  train loss: 0.2723347822692075 0.2713367830281061 0.010695757318498986 0.08910410849199214 validation loss: 0.2928473896111924 0.29182406004462164 0.011699424645324063 0.09063347727944458
epoch 151 time used: 40  seconds  train loss: 0.2747681740529097 0.27376396245851925 0.011355545101345737 0.08906567136735391 validation loss: 0.3158393342138044 0.31482869562140775 0.011059096393450442 0.09000471377144226
epoch 152 time used: 40  seconds  train loss: 0.27532745890286464 0.27432600390310613 0.011213161741296775 0.08893240822938057 validation loss: 0.3026578041420087 0.30162489301317197 0.01255937286137018 0.09073195155898711
epoch 153 time used: 40  seconds  train loss: 0.2735204021510895 0.2725183776008758 0.011310124846980069 0.0888923612917745 validation loss: 0.2989400557898213 0.29791015729355735 0.012867919065862458 0.09012159294376956
epoch 154 time used: 40  seconds  train loss: 0.2737415900215531 0.2727333371442595 0.01199297179997913 0.08883241542718887 validation loss: 0.3150324994627606 0.3140197047519118 0.01139162046327296 0.08988749311360417
epoch 155 time used: 40  seconds  train loss: 0.27587775114808627 0.2748618435186622 0.013017444310106338 0.08857328931144376 validation loss: 0.29621596254207727 0.2951879855542899 0.013988134404665623 0.08880964419385821
epoch 156 time used: 40  seconds  train loss: 0.27294969668019725 0.2719651934101309 0.009957022187978216 0.08849325009045254 validation loss: 0.313010163635818 0.3119778933181223 0.014003924344080135 0.08922334066037443
epoch 157 time used: 40  seconds  train loss: 0.2770630301242367 0.27604366904469024 0.01373217424884917 0.08820391634799196 validation loss: 0.2998037833375291 0.2987051045089375 0.0211666369908891 0.08870124880824662
epoch 158 time used: 40  seconds  train loss: 0.2763574631305576 0.2753233273830103 0.015199080010525414 0.08821452623668317 validation loss: 0.29870161118979655 0.2976709339701384 0.014942574208240578 0.08812496780886708
epoch 159 time used: 40  seconds  train loss: 0.27364971836922 0.2726432073426526 0.012642018228903665 0.08800916379512382 validation loss: 0.29063007806817565 0.2896293398181579 0.012252735364238512 0.08782089541405644
epoch 160 time used: 40  seconds  train loss: 0.27233699924723415 0.27134802818679316 0.010871132192139692 0.08802614134276154 validation loss: 0.29365976732215726 0.29267022448933216 0.010889387917366952 0.08806474929201935
epoch 161 time used: 40  seconds  train loss: 0.2712049627028323 0.2702306113301519 0.009488430071614764 0.08794696640272588 validation loss: 0.2979525076314664 0.2969640202034777 0.010699427343602325 0.08814920054511467
epoch 162 time used: 40  seconds  train loss: 0.2730138598421251 0.27203221441113484 0.01040874588819315 0.08775570625820546 validation loss: 0.3002305882453701 0.2992164828580354 0.012837675555652949 0.08857275805398243
epoch 163 time used: 40  seconds  train loss: 0.2745766657397657 0.2735684889760886 0.01338061372850279 0.08743726793665843 validation loss: 0.3010394897078989 0.3000180832956654 0.013911137729341234 0.08822908517719676
epoch 164 time used: 40  seconds  train loss: 0.2725081418478912 0.2715140898021602 0.011977711520956415 0.08742734058850106 validation loss: 0.29154890638298775 0.29054869373385517 0.012596399639573735 0.0874252071606683
epoch 165 time used: 40  seconds  train loss: 0.27240912000114487 0.27141258444820177 0.012320390721821877 0.0873331662112675 validation loss: 0.29310509351658964 0.2921096360449484 0.012176098901564226 0.08736999796738314
epoch 166 time used: 40  seconds  train loss: 0.27285366157856983 0.27186124041969056 0.012005570347178083 0.08723657932333742 validation loss: 0.2971391315086962 0.2961356887421288 0.013767086116840195 0.08657759871794611
epoch 167 time used: 40  seconds  train loss: 0.27192760742957 0.27093773324220005 0.011978343729394074 0.0870091931208721 validation loss: 0.29450277069397357 0.29350299876827673 0.012733338400509017 0.08724379427612018
epoch 168 time used: 40  seconds  train loss: 0.27199023729806765 0.27101196044566445 0.010879236766554017 0.0869485451340258 validation loss: 0.3036576230631523 0.30263454891785485 0.01566587522592343 0.08664147404504116
Early stopping at epoch: 169 
trainval loss, loss1, loss2, loss3 0.28662722530062407 0.2856589611317844 0.010204452182013431 0.08662205575175602
YS.shape, YS_pred.shape, (8762, 6, 1843, 1) (8762, 6, 1843, 1)
YS.shape, YS_pred.shape, (8762, 6, 1843) (8762, 6, 1843)
**************************************** 
MMGCRN, train, Torch MSE, 0.270353, 0.269380, 0.010655, 0.086628 
MMGCRN, train, MSE, RMSE, MAE, MAPE, 32.722023, 5.720317, 3.483910, 11.395237 
Model Training Ended ... Tue Feb  8 06:40:30 2022
tokyo 202112 testing started Tue Feb  8 06:40:30 2022
TEST XS.shape, YS.shape, XCov.shape, YCov.shape, YMask.shape (4453, 6, 1843, 1) (4453, 6, 1843, 1) (4453, 6, 1843, 1) (4453, 6, 1843, 1) (4453, 1843)
Model Testing Started ... Tue Feb  8 06:40:32 2022
TIMESTEP_IN, TIMESTEP_OUT 6 6
test loss, loss1, loss2, loss3 0.3019554730201073 0.30094165449166016 0.013809395733260349 0.0875723965544661
YS.shape, YS_pred.shape, (4453, 6, 1843, 1) (4453, 6, 1843, 1)
********* Evaluation on the whole testing dataset ********* 
YS.shape, YS_pred.shape, (4453, 1843, 6) (4453, 1843, 6)
MMGCRN, test, Torch MSE, 0.301955, 0.300942, 0.013809, 0.087572 
all pred steps, MMGCRN, test, MSE, RMSE, MAE, MAPE, 36.501312, 6.041632, 3.666162, 11.705536 
1 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 31.366977, 5.600623, 3.475615, 12.000292 
2 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 28.358658, 5.325285, 3.152250, 9.679496 
3 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 31.855038, 5.644027, 3.360129, 10.854653 
4 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 36.826958, 6.068522, 3.662951, 12.006384 
5 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 42.710202, 6.535304, 4.026162, 12.698877 
6 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 47.890037, 6.920263, 4.319865, 12.993516 
********* Evaluation on the selected testing dataset when incident happen at t+1 ********* 
YS.shape, YS_pred.shape, (100960, 6) (100960, 6)
MMGCRN, test, Torch MSE, 0.301955, 0.300942, 0.013809, 0.087572 
all pred steps, MMGCRN, test, MSE, RMSE, MAE, MAPE, 108.575224, 10.419944, 6.164455, 33.665092 
1 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 128.811829, 11.349530, 6.794592, 41.003371 
2 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 83.833838, 9.156082, 5.250983, 28.436313 
3 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 86.852319, 9.319459, 5.464962, 31.427869 
4 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 98.187227, 9.908947, 5.900424, 32.363582 
5 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 119.214534, 10.918541, 6.549721, 34.635921 
6 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 134.551596, 11.599638, 7.026048, 34.123498 
Model Testing Ended ... Tue Feb  8 06:40:49 2022
