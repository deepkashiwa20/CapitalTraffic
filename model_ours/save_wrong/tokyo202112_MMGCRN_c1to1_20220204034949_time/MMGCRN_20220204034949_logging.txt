lamb 0.01
lamb1 0.0
experiment_city tokyo
experiment_month 202112
model_name MMGCRN
memory_type local
mem_num 10
mem_dim 32
meta_type yes
decoder_type stepwise
go_type last
ycov_type time
batch_size 64
rnn_units 32
num_layers 1
channnel_in 1
channnel_out 1
feature_time True
feature_history False
train_data (4464, 1843, 2)
train_data (4320, 1843, 2)
test_data (4464, 1843, 2)
tokyo 202112 training started Fri Feb  4 03:50:47 2022
TRAIN XS.shape YS.shape, XCov.shape, YCov.shape (8762, 6, 1843, 1) (8762, 6, 1843, 1) (8762, 6, 1843, 1) (8762, 6, 1843, 1)
Model Training Started ... Fri Feb  4 03:50:50 2022
TIMESTEP_IN, TIMESTEP_OUT 6 6
Trainable parameter list: 

 In total: 64217 trainable parameters. 
 
XS_torch.shape:   torch.Size([8762, 6, 1843, 1])
YS_torch.shape:   torch.Size([8762, 6, 1843, 1])
YCov_torch.shape:   torch.Size([8762, 6, 1843, 1])
epoch 0 time used: 40  seconds  train loss: 0.6658182162714955 0.6456091489771552 2.0209068225464524 0.11230077819079229 validation loss: 0.6791670795501176 0.6702232402734483 0.8943845501015688 0.044695420159236963
epoch 1 time used: 40  seconds  train loss: 0.6080718067089294 0.6040461260993774 0.40256770074780246 0.04125718381230353 validation loss: 0.6785523951298458 0.674443408568011 0.41089916752931027 0.042743454642665275
epoch 2 time used: 40  seconds  train loss: 0.6147437908890366 0.6111600540840286 0.3583736322982328 0.027807864012842107 validation loss: 0.6732402403895467 0.6710587690432612 0.2181465454205755 0.03572136280860111
epoch 3 time used: 40  seconds  train loss: 0.6221004322028345 0.6197407131615231 0.23597197579550175 0.025000429867999663 validation loss: 0.6693069595607216 0.6679452842416854 0.13616748001139112 0.026845498123584083
epoch 4 time used: 40  seconds  train loss: 0.6128981570786781 0.6120424214390529 0.08557363833793856 0.02332203921648923 validation loss: 0.6583696830658976 0.6576593114545171 0.0710372565265716 0.028208009291666385
epoch 5 time used: 40  seconds  train loss: 0.6012982087825789 0.6006571909296805 0.06410198114169477 0.022573083790231468 validation loss: 0.6532423587924865 0.6527046965225164 0.053766327562845224 0.02872305610720859
epoch 6 time used: 40  seconds  train loss: 0.5954159691333408 0.5948931258701875 0.052284097037342034 0.02200818815022104 validation loss: 0.6499648969611965 0.6495789429304645 0.03859535603355132 0.027246405791775216
epoch 7 time used: 40  seconds  train loss: 0.591510167569625 0.5911044172637631 0.04057501588983929 0.02099299275225164 validation loss: 0.6476329470921303 0.647392001994284 0.024094464479244664 0.026418670313114012
epoch 8 time used: 40  seconds  train loss: 0.5882751883128483 0.5879858267568522 0.02893650913420956 0.020528956799009786 validation loss: 0.6465402562995851 0.6463651590181888 0.017509810829689002 0.025198613446068132
epoch 9 time used: 40  seconds  train loss: 0.5858378772085396 0.5856460757160129 0.019180110886261356 0.02002559652377111 validation loss: 0.6450917258593438 0.6449390026272731 0.015272252606793334 0.025710252273040565
epoch 10 time used: 40  seconds  train loss: 0.5831812343184144 0.5829847974377015 0.019643534062193 0.021362214962769147 validation loss: 0.6426214799386951 0.642494731436903 0.012674715738048133 0.030038705252923688
epoch 11 time used: 40  seconds  train loss: 0.5777834860216517 0.5775628631208571 0.022062171380408478 0.026817234319478404 validation loss: 0.6394229435801017 0.6376463076884428 0.17766342890529205 0.03156898713690649
epoch 12 time used: 40  seconds  train loss: 0.5710477445327315 0.5701493391561065 0.08984063339356309 0.02722178507902963 validation loss: 0.6240915946903864 0.6234153560828205 0.06762401379444238 0.029473849939074433
epoch 13 time used: 40  seconds  train loss: 0.5563162800212045 0.555811069274199 0.050521115393292376 0.025829957721021018 validation loss: 0.6010787341214924 0.6002567988016572 0.08219396555052398 0.031423983413646175
epoch 14 time used: 40  seconds  train loss: 0.5351632839286188 0.5346183263943486 0.05449557246116199 0.028780212471656488 validation loss: 0.5831004292493757 0.5825100406997555 0.05903936893985675 0.03402090574041288
epoch 15 time used: 40  seconds  train loss: 0.5255740614010671 0.5250787270012883 0.04953327797111756 0.03142498761926851 validation loss: 0.5847056546966435 0.5838062112759043 0.08994500944327133 0.03705044824924169
epoch 16 time used: 40  seconds  train loss: 0.5242361376962602 0.5235715003213895 0.06646354140617716 0.03209569084646132 validation loss: 0.5830116826124465 0.5821138886162702 0.08977975941844206 0.038572386143510606
epoch 17 time used: 40  seconds  train loss: 0.5164146522166903 0.5157018092565387 0.07128428442883013 0.03235444638482957 validation loss: 0.5775802458654741 0.5766847863800174 0.08954596683376187 0.04006408533954501
epoch 18 time used: 40  seconds  train loss: 0.5095872758521898 0.5087798052891044 0.08074698091577158 0.03420730513947011 validation loss: 0.5692729018747616 0.5680117049156287 0.12611959498530378 0.04370561184804497
epoch 19 time used: 40  seconds  train loss: 0.504441371157804 0.5029975539916655 0.14438162240839097 0.03962575142068998 validation loss: 0.5633827925326889 0.5606803054789983 0.27024848853709327 0.050670884092245294
epoch 20 time used: 40  seconds  train loss: 0.5012783324350198 0.49811830909407095 0.3160023436601114 0.04537655555960196 validation loss: 0.558161242701375 0.5555629488106244 0.2598292670637328 0.046564362868360604
epoch 21 time used: 40  seconds  train loss: 0.49628174147582677 0.49463891389344206 0.1642827926986821 0.038590673711011984 validation loss: 0.5506621378298384 0.5489957442788542 0.16663957299134982 0.04393123967436175
epoch 22 time used: 40  seconds  train loss: 0.4919200837884278 0.49055140444068057 0.1368679970280617 0.03822490300803474 validation loss: 0.5466539218022038 0.5450559748682677 0.15979482138989343 0.044039794467032524
epoch 23 time used: 40  seconds  train loss: 0.4883189464999631 0.4869688332008274 0.13501138746366528 0.038460292088769554 validation loss: 0.5431700397549781 0.5416837618645878 0.1486273507027798 0.04389799361779014
epoch 24 time used: 40  seconds  train loss: 0.4849494111499836 0.48375325502008265 0.1196156939021929 0.0384352579287671 validation loss: 0.5396321432767857 0.5383237386500656 0.1308402982763589 0.043442906496433405
epoch 25 time used: 40  seconds  train loss: 0.48197930965534613 0.480940855106359 0.10384549970197597 0.038856907900048074 validation loss: 0.536533298747064 0.5353427408819925 0.1190564117030105 0.04379446498134919
epoch 26 time used: 40  seconds  train loss: 0.47942116988102534 0.4784386526085147 0.09825173687411487 0.03991267582385476 validation loss: 0.53397505354631 0.5328406010355268 0.1134453206397474 0.0445823022124023
epoch 27 time used: 40  seconds  train loss: 0.47716828719464055 0.4762116462477555 0.09566413137334392 0.04108506887289437 validation loss: 0.5318583004390851 0.530742400125628 0.11159019395947076 0.045521823584774974
epoch 28 time used: 40  seconds  train loss: 0.47514899413601264 0.4742085814176675 0.09404138398667554 0.04234112886247924 validation loss: 0.5301112959451296 0.5290122233205383 0.10990710811547523 0.046597384293837835
epoch 29 time used: 40  seconds  train loss: 0.4733117393499603 0.4723814529582366 0.09302859917779688 0.04370503944519574 validation loss: 0.5286371898346435 0.5275460808639492 0.10911051576021108 0.04777701650306222
epoch 30 time used: 40  seconds  train loss: 0.471624469357055 0.47070918911270054 0.09152816517556064 0.04512991580792965 validation loss: 0.5273562569914207 0.5262738853380159 0.1082370042773699 0.04909096581887731
epoch 31 time used: 40  seconds  train loss: 0.4700200574716609 0.46911949990565255 0.09005583018084909 0.046642832105389435 validation loss: 0.5263070073480315 0.5252396770396335 0.10673277568376428 0.05047324697845388
epoch 32 time used: 40  seconds  train loss: 0.4685044917518228 0.46761215248802374 0.08923383485942539 0.04822417570689355 validation loss: 0.5254568995160634 0.5244080557337856 0.10488449902172123 0.05191921061036631
epoch 33 time used: 40  seconds  train loss: 0.4670212904742239 0.4661311769826538 0.08901134113893264 0.04987543024913014 validation loss: 0.5248412600612596 0.5238008260563702 0.10404359611513841 0.053416195197608145
epoch 34 time used: 40  seconds  train loss: 0.4655045936358354 0.4646139150339979 0.08906788199804377 0.051569645641860014 validation loss: 0.524296964210552 0.5232618764512129 0.10350890989474432 0.054913349521045866
epoch 35 time used: 40  seconds  train loss: 0.4638677327269344 0.4629758323341939 0.08919019580483799 0.053367552309638744 validation loss: 0.5233910019296536 0.5223576523353388 0.10333500329842038 0.05639121123423374
epoch 36 time used: 40  seconds  train loss: 0.4618762549998789 0.460995588322931 0.08806661513366577 0.055251376348200536 validation loss: 0.5213534683465196 0.5203310511581215 0.10224214081947035 0.05805514910989894
epoch 37 time used: 40  seconds  train loss: 0.4596728176046336 0.45882222948054746 0.08505890204404935 0.057225579409213065 validation loss: 0.5186001712848257 0.5175957506185033 0.10044224613989286 0.05993490328817594
epoch 38 time used: 40  seconds  train loss: 0.45748051649503485 0.45664688125264064 0.08336357617181851 0.05925099563469827 validation loss: 0.5164335821927383 0.5154364847364299 0.09970996960392285 0.061870204214225996
epoch 39 time used: 40  seconds  train loss: 0.45540344747773515 0.45456497830409215 0.08384688586600975 0.061222620389470045 validation loss: 0.5148787208204125 0.513887577462773 0.09911415504571348 0.06375020021162094
epoch 40 time used: 40  seconds  train loss: 0.4534402895447254 0.4525899105357935 0.08503802232824129 0.06302676538325502 validation loss: 0.5136485563353935 0.5126697244789981 0.09788300309182302 0.06549860248686461
epoch 41 time used: 40  seconds  train loss: 0.4515612303276364 0.4507082967503469 0.08529328600279709 0.0645946370101269 validation loss: 0.5126195646540208 0.5116661933392272 0.09533724997452762 0.06699384646239427
epoch 42 time used: 40  seconds  train loss: 0.44982364283016585 0.4489849228426086 0.08387199340504682 0.0659058517815406 validation loss: 0.5118091204350314 0.5108870936822042 0.09220312641179491 0.0682147045261454
epoch 43 time used: 40  seconds  train loss: 0.4481980006474553 0.44738066688082456 0.0817332989121659 0.06701500603727618 validation loss: 0.5111432183773645 0.5102521342972216 0.08910815000180401 0.0692274489396242
epoch 44 time used: 40  seconds  train loss: 0.4467066513124149 0.44591988158033713 0.07867701316535532 0.0679397579651593 validation loss: 0.5105930754769507 0.5097378933337223 0.08551823686840652 0.070042303769706
epoch 45 time used: 40  seconds  train loss: 0.4453214747940926 0.44457416057024274 0.07473150066540422 0.06873795762828198 validation loss: 0.5101844025278461 0.5093621947568391 0.082220536873037 0.0707565794989215
epoch 46 time used: 40  seconds  train loss: 0.44400646282991235 0.4433046924325905 0.07017695306220763 0.06945770811343407 validation loss: 0.5098208784785024 0.5090346058064648 0.07862715536685144 0.07142117628355867
epoch 47 time used: 40  seconds  train loss: 0.44273434158711106 0.44207170716324024 0.06626346985592796 0.07023269941642248 validation loss: 0.509488164453624 0.5087251565272489 0.07630067628466991 0.0721534353815655
epoch 48 time used: 40  seconds  train loss: 0.4415408121298626 0.4409082426208101 0.06325692183894688 0.07105448550193609 validation loss: 0.5090522257936757 0.5083105832079892 0.07416429111180595 0.07290281636605574
epoch 49 time used: 40  seconds  train loss: 0.44038694662475236 0.43977265047021985 0.061429637519118584 0.07199367867781861 validation loss: 0.5086421673018222 0.507908688104082 0.07334762300899833 0.07374199820212282
epoch 50 time used: 41  seconds  train loss: 0.43924133183204717 0.4386361054344784 0.0605227017667178 0.07289788012425842 validation loss: 0.5081202083393517 0.5073950580677884 0.0725148962491835 0.07452209135037152
epoch 51 time used: 40  seconds  train loss: 0.43816419506141935 0.4375610884475737 0.06031058252375364 0.07376738156136303 validation loss: 0.507575353276833 0.5068496771187393 0.0725677799737818 0.07525154442914486
epoch 52 time used: 40  seconds  train loss: 0.4371080598390696 0.43650308416924183 0.060497559139312554 0.07455485676511785 validation loss: 0.5070589331120239 0.5063352780165818 0.07236521289480272 0.07594889911450191
epoch 53 time used: 40  seconds  train loss: 0.4360947779253218 0.43548711528881123 0.06076631397819604 0.07530880614768205 validation loss: 0.5065056745291082 0.5057825915675248 0.07230832515814054 0.07658837099072052
epoch 54 time used: 40  seconds  train loss: 0.43509902730595484 0.43448685737999404 0.06121701148346128 0.07600988153883573 validation loss: 0.5058517960966694 0.5051262782676641 0.07255182546167709 0.07722667347944147
epoch 55 time used: 40  seconds  train loss: 0.43412083904414106 0.43350143039213834 0.06194080515937425 0.076649354077142 validation loss: 0.5051856700931168 0.5044572307931838 0.07284413661003548 0.07781644670495917
epoch 56 time used: 40  seconds  train loss: 0.43318310258432424 0.4325557444134072 0.06273582933467489 0.07723494797146786 validation loss: 0.5046039639080784 0.5038707287330053 0.07332348392359038 0.07833351817157158
epoch 57 time used: 40  seconds  train loss: 0.43224754958115763 0.4316115812376525 0.06359685771422396 0.0777621378711398 validation loss: 0.5040707050094535 0.5033316867420087 0.07390159213450444 0.07878245481314151
epoch 58 time used: 40  seconds  train loss: 0.4313236938330558 0.43067819637044746 0.06454981717429437 0.07822473291628003 validation loss: 0.5037009861576998 0.5029542837878549 0.0746696425430963 0.07921168118688082
epoch 59 time used: 40  seconds  train loss: 0.4304256292986663 0.4297722684268519 0.06533603699901386 0.07866069180583359 validation loss: 0.5032442544269431 0.5024890403995662 0.07552151720663121 0.07958360592397257
epoch 60 time used: 40  seconds  train loss: 0.42955483179389203 0.4288925997943498 0.06622329433911368 0.0790535987201319 validation loss: 0.5030155253432103 0.5022532103106291 0.0762318773513948 0.07994008397522825
epoch 61 time used: 40  seconds  train loss: 0.4286885242486831 0.42801763474025095 0.06708897805013463 0.07944844136919683 validation loss: 0.5027506871617368 0.5019796052407804 0.07710815753935679 0.08030950537844914
epoch 62 time used: 41  seconds  train loss: 0.4278412096541397 0.4271620233215674 0.06791864365513327 0.079837396592378 validation loss: 0.5026503739319996 0.5018723642428897 0.07780129570957733 0.08061980853296752
epoch 63 time used: 40  seconds  train loss: 0.42704368864015035 0.42635994017115103 0.06837480841594287 0.08020658204633883 validation loss: 0.5025422250718518 0.5017599319824069 0.07822898060205809 0.08091049491407011
epoch 64 time used: 40  seconds  train loss: 0.4262551860828556 0.4255697833695308 0.0685402732331143 0.08056232415614761 validation loss: 0.502508741190095 0.5017262572352063 0.07824822081340496 0.08123704736320356
epoch 65 time used: 40  seconds  train loss: 0.42548875518629603 0.42480476046149146 0.06839929240142179 0.08093044303982357 validation loss: 0.5026871378919078 0.5019038198528525 0.0783320087675959 0.08157746253398279
epoch 66 time used: 40  seconds  train loss: 0.4247525297575863 0.4240694987666859 0.06830306406318688 0.08128924182770804 validation loss: 0.5026797079049741 0.5018944336039353 0.07852745716536987 0.08185625673768619
epoch 67 time used: 40  seconds  train loss: 0.42403248773827945 0.42335169267897516 0.06807953043422857 0.08165294940074164 validation loss: 0.5029515570181791 0.5021700476849259 0.07815078599357213 0.08223367516429171
epoch 68 time used: 40  seconds  train loss: 0.4233308739040635 0.4226533550728839 0.0677518773077898 0.08202878957019878 validation loss: 0.5031765602539251 0.5023965336100145 0.078002217172597 0.08258302176871946
epoch 69 time used: 40  seconds  train loss: 0.42263275530943856 0.4219612648744341 0.06714903360924081 0.08241034877062606 validation loss: 0.5033466476982775 0.5025697630978457 0.07768836540957663 0.08296762420428175
epoch 70 time used: 40  seconds  train loss: 0.42196633531030975 0.42129917022590857 0.06671670986232583 0.08278111327598854 validation loss: 0.5034839393122998 0.5027079711162789 0.07759716296810801 0.08327159258681092
epoch 71 time used: 40  seconds  train loss: 0.421307352176632 0.4206476775755568 0.06596741548652492 0.08317412682962715 validation loss: 0.5038929595516349 0.5031214958997907 0.077146374025828 0.08367777210781423
epoch 72 time used: 40  seconds  train loss: 0.42064844041250915 0.419998003311343 0.06504389139896041 0.08357908057306586 validation loss: 0.5042613324973203 0.5034937959509536 0.07675330217762769 0.08402167532009819
epoch 73 time used: 40  seconds  train loss: 0.4200327372581805 0.4193921047355682 0.0640631407956258 0.08402749616213358 validation loss: 0.5045094253917852 0.5037421453548642 0.07672790035653038 0.08442960744141335
Early stopping at epoch: 74 
trainval loss, loss1, loss2, loss3 0.4468176085650717 0.44615141394692887 0.06661947993648784 0.08289533410849731
YS.shape, YS_pred.shape, (8762, 6, 1843, 1) (8762, 6, 1843, 1)
YS.shape, YS_pred.shape, (8762, 6, 1843) (8762, 6, 1843)
**************************************** 
MMGCRN, train, Torch MSE, 0.419426, 0.418794, 0.063206, 0.084444 
MMGCRN, train, MSE, RMSE, MAE, MAPE, 235.108602, 15.333252, 10.600911, 20.317093 
Model Training Ended ... Fri Feb  4 04:42:09 2022
tokyo 202112 testing started Fri Feb  4 04:42:09 2022
TEST XS.shape, YS.shape, XCov.shape, YCov.shape, YMask.shape (4453, 6, 1843, 1) (4453, 6, 1843, 1) (4453, 6, 1843, 1) (4453, 6, 1843, 1) (4453, 1843)
Model Testing Started ... Fri Feb  4 04:42:11 2022
TIMESTEP_IN, TIMESTEP_OUT 6 6
test loss, loss1, loss2, loss3 0.48151597551300424 0.4808057620100779 0.07102124765097037 0.08040125066213279
YS.shape, YS_pred.shape, (4453, 6, 1843, 1) (4453, 6, 1843, 1)
********* Evaluation on the whole testing dataset ********* 
YS.shape, YS_pred.shape, (4453, 1843, 6) (4453, 1843, 6)
MMGCRN, test, Torch MSE, 0.481516, 0.480806, 0.071021, 0.080401 
all pred steps, MMGCRN, test, MSE, RMSE, MAE, MAPE, 265.716224, 16.300804, 11.424357, 22.342386 
1 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 231.216349, 15.205800, 10.297261, 20.148776 
2 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 242.247419, 15.564299, 10.799612, 22.636627 
3 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 254.301334, 15.946828, 11.104981, 21.179672 
4 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 263.081861, 16.219798, 11.350372, 21.538235 
5 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 274.630147, 16.571969, 11.788865, 22.761237 
6 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 328.820235, 18.133401, 13.205051, 25.789768 
********* Evaluation on the selected testing dataset when incident happen at t+1 ********* 
YS.shape, YS_pred.shape, (81745, 6) (81745, 6)
MMGCRN, test, Torch MSE, 0.481516, 0.480806, 0.071021, 0.080401 
all pred steps, MMGCRN, test, MSE, RMSE, MAE, MAPE, 466.774611, 21.604967, 14.953679, 26.803948 
1 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 1313.877767, 36.247452, 28.531728, 49.478197 
2 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 285.922096, 16.909231, 11.846282, 22.024287 
3 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 231.523718, 15.215903, 10.690974, 18.638525 
4 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 280.692396, 16.753877, 11.904234, 21.188626 
5 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 351.081934, 18.737181, 13.419815, 24.771858 
6 step, MMGCRN, test, MSE, RMSE, MAE, MAPE, 337.549757, 18.372527, 13.329040, 24.722192 
Model Testing Ended ... Fri Feb  4 04:42:27 2022
