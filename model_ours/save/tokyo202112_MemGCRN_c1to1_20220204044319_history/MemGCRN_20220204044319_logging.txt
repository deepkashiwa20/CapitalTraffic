lamb 0.01
lamb1 0.01
experiment_city tokyo
experiment_month 202112
model_name MemGCRN
mem_num 10
mem_dim 32
decoder_type stepwise
go_type random
ycov_type history
batch_size 64
rnn_units 32
num_layers 1
channnel_in 1
channnel_out 1
feature_time False
feature_history True
train_data (4464, 1843, 2)
train_data (4320, 1843, 2)
test_data (4464, 1843, 2)
tokyo 202112 training started Fri Feb  4 04:44:15 2022
TRAIN XS.shape YS.shape, XCov.shape, YCov.shape (8762, 6, 1843, 1) (8762, 6, 1843, 1) (8762, 6, 1843, 1) (8762, 6, 1843, 1)
Model Training Started ... Fri Feb  4 04:44:20 2022
TIMESTEP_IN, TIMESTEP_OUT 6 6
Trainable parameter list: 

 In total: 63961 trainable parameters. 
 
XS_torch.shape:   torch.Size([8762, 6, 1843, 1])
YS_torch.shape:   torch.Size([8762, 6, 1843, 1])
YCov_torch.shape:   torch.Size([8762, 6, 1843, 1])
epoch 0 time used: 39  seconds  train loss: 0.446669998279247 0.4179440179320707 2.74208716266033 0.13051100250766115 validation loss: 0.30637491598133626 0.2889236703630671 1.6541740898126231 0.09095041400449888
epoch 1 time used: 39  seconds  train loss: 0.27995638095331127 0.26875716486834916 1.062563229071606 0.05735845588348333 validation loss: 0.26987314305856097 0.2657095542350135 0.3854094801809841 0.030949362560032112
epoch 2 time used: 39  seconds  train loss: 0.2600879670164571 0.25915832344735706 0.0668717432166775 0.02609251399602888 validation loss: 0.2603734309463292 0.2598068322807836 0.03710747689828243 0.0195524700730699
epoch 3 time used: 39  seconds  train loss: 0.25627243998224486 0.2559309085175393 0.016742952298948417 0.017410214903920758 validation loss: 0.25713519118845274 0.2569806355012165 0.0026674718484301623 0.012788228786689459
epoch 4 time used: 40  seconds  train loss: 0.2546268221613951 0.2544948929970966 0.0015682006049847388 0.01162454691773507 validation loss: 0.2560239324744898 0.2559223703764607 0.0010785436498308117 0.009077482493377505
epoch 5 time used: 39  seconds  train loss: 0.2538451759637609 0.2537520295806969 0.0010154680287279218 0.008299176351172506 validation loss: 0.25505761283274275 0.2549798749506283 0.0009063251115915602 0.006867420239886673
epoch 6 time used: 39  seconds  train loss: 0.25324227109726044 0.25317333236828804 0.0007536243264659901 0.006140168401349028 validation loss: 0.25441637526413774 0.2543546809882456 0.001019534055145295 0.005150185544077784
epoch 7 time used: 39  seconds  train loss: 0.2528431109915112 0.2527896302659079 0.0006284252928237976 0.004719676862123137 validation loss: 0.2540061698554042 0.2539591361049755 0.00043501588292776966 0.004268563040419529
epoch 8 time used: 39  seconds  train loss: 0.25248790403884436 0.2524457814019123 0.0003873539940849357 0.0038249181006531786 validation loss: 0.25366127129179983 0.2536222159400045 0.0003244435556644394 0.0035811469186478244
epoch 9 time used: 39  seconds  train loss: 0.25222237646271334 0.252189122168754 0.00022786386960754835 0.003097564591954599 validation loss: 0.2534403697315932 0.2534106727170922 0.0001896993975044113 0.0027800366952581757
epoch 10 time used: 39  seconds  train loss: 0.25204236318787165 0.2520151515789653 0.00017021461105785709 0.002551016585445427 validation loss: 0.25329867952058216 0.2532689943535586 0.00039170976305896493 0.0025766425585822257
epoch 11 time used: 40  seconds  train loss: 0.2518904151514302 0.2518655218783805 0.00014566897006861024 0.0023437032840390275 validation loss: 0.2531329997594582 0.25309920621103266 0.0004961455877596578 0.002883359190715891
epoch 12 time used: 39  seconds  train loss: 0.25170202436258104 0.25167827272348037 0.00026262677545618707 0.0021124012863441787 validation loss: 0.25308256854427724 0.2530453265230169 0.0016909045915810934 0.0020328666100411117
epoch 13 time used: 39  seconds  train loss: 0.251589292996261 0.25156659648681845 0.00044561132704752654 0.0018240097296677769 validation loss: 0.2530492805131545 0.25300310166499107 0.002593653618316844 0.002024131620792474
epoch 14 time used: 39  seconds  train loss: 0.25148874320789405 0.25146714757247485 0.00023401175315086926 0.001925507285695264 validation loss: 0.2529614313668391 0.2529429007425313 0.00019827325429235186 0.001654790410406833
epoch 15 time used: 39  seconds  train loss: 0.25138766665180023 0.25136909846246486 0.00018628695397194872 0.0016703581171153643 validation loss: 0.2529769643413482 0.25295714867381625 0.000175200610169533 0.0018065108870152283
epoch 16 time used: 39  seconds  train loss: 0.2513005084877888 0.25128476541892447 8.489879925643594e-05 0.0014894012031670511 validation loss: 0.25299590188093457 0.2529815145819658 0.00010116443561669737 0.001337495654334056
epoch 17 time used: 39  seconds  train loss: 0.25115264553291544 0.2511388332608664 8.313354967056281e-05 0.0012980577955862217 validation loss: 0.25297584619657026 0.25296177649432694 0.00016131859896717306 0.0012458084888746924
epoch 18 time used: 39  seconds  train loss: 0.25108206217700063 0.25106974361313295 4.455626743367012e-05 0.0011873212498932308 validation loss: 0.2531352426256561 0.25312285974710186 9.188640884806826e-05 0.001146243898841348
epoch 19 time used: 39  seconds  train loss: 0.2510070814183451 0.250995574692235 3.790108280364391e-05 0.001112780810303741 validation loss: 0.2531557832472621 0.2531438424455581 6.713516183881007e-05 0.0011267845541415612
epoch 20 time used: 39  seconds  train loss: 0.2509405928475547 0.2509296965179986 3.7060023825873594e-05 0.001052553282593995 validation loss: 0.2532054123909492 0.25319454851269124 1.2606508189932172e-05 0.0010736838438697347
epoch 21 time used: 39  seconds  train loss: 0.2508158358427655 0.2508055897580672 2.7904761783646007e-05 0.0009968163493745455 validation loss: 0.2531469807960518 0.2531361194273915 3.17145405921257e-05 0.0010546936660939985
epoch 22 time used: 39  seconds  train loss: 0.2507400023685055 0.25072986617505216 3.913961285154055e-05 0.0009745484920780697 validation loss: 0.25327549328656024 0.25326429769934067 2.1071529032051265e-05 0.0010982275673110482
epoch 23 time used: 39  seconds  train loss: 0.2506785312257316 0.25066902723745604 2.5771527103665865e-05 0.0009246594168380722 validation loss: 0.2531228822790722 0.25311281050192824 2.0335946573834612e-05 0.0009866299255434823
Early stopping at epoch: 24 
trainval loss, loss1, loss2, loss3 0.2504025600294467 0.2503932690040838 8.21442837123048e-06 0.0009208492797003713
YS.shape, YS_pred.shape, (8762, 6, 1843, 1) (8762, 6, 1843, 1)
YS.shape, YS_pred.shape, (8762, 6, 1843) (8762, 6, 1843)
**************************************** 
MemGCRN, train, Torch MSE, 0.250640, 0.250631, 0.000035, 0.000911 
MemGCRN, train, MSE, RMSE, MAE, MAPE, 90.053556, 9.489655, 5.949546, 12.505032 
Model Training Ended ... Fri Feb  4 05:01:26 2022
tokyo 202112 testing started Fri Feb  4 05:01:26 2022
TEST XS.shape, YS.shape, XCov.shape, YCov.shape, YMask.shape (4453, 6, 1843, 1) (4453, 6, 1843, 1) (4453, 6, 1843, 1) (4453, 6, 1843, 1) (4453, 1843)
Model Testing Started ... Fri Feb  4 05:01:28 2022
TIMESTEP_IN, TIMESTEP_OUT 6 6
test loss, loss1, loss2, loss3 0.34050576484206013 0.3404878287965358 7.825308828013361e-05 0.0017151357202664981
YS.shape, YS_pred.shape, (4453, 6, 1843, 1) (4453, 6, 1843, 1)
********* Evaluation on the whole testing dataset ********* 
YS.shape, YS_pred.shape, (4453, 1843, 6) (4453, 1843, 6)
MemGCRN, test, Torch MSE, 0.340506, 0.340488, 0.000078, 0.001715 
all pred steps, MemGCRN, test, MSE, RMSE, MAE, MAPE, 161.785635, 12.719498, 8.090355, 18.845533 
1 step, MemGCRN, test, MSE, RMSE, MAE, MAPE, 161.897812, 12.723907, 8.131444, 18.380275 
2 step, MemGCRN, test, MSE, RMSE, MAE, MAPE, 161.481395, 12.707533, 8.073609, 18.820441 
3 step, MemGCRN, test, MSE, RMSE, MAE, MAPE, 161.631357, 12.713432, 8.082318, 18.992089 
4 step, MemGCRN, test, MSE, RMSE, MAE, MAPE, 161.724270, 12.717086, 8.081342, 18.943317 
5 step, MemGCRN, test, MSE, RMSE, MAE, MAPE, 161.915910, 12.724618, 8.084973, 18.918557 
6 step, MemGCRN, test, MSE, RMSE, MAE, MAPE, 162.063066, 12.730399, 8.088444, 19.018517 
********* Evaluation on the selected testing dataset when incident happen at t+1 ********* 
YS.shape, YS_pred.shape, (81745, 6) (81745, 6)
MemGCRN, test, Torch MSE, 0.340506, 0.340488, 0.000078, 0.001715 
all pred steps, MemGCRN, test, MSE, RMSE, MAE, MAPE, 308.771218, 17.571887, 10.717377, 23.854084 
1 step, MemGCRN, test, MSE, RMSE, MAE, MAPE, 955.696497, 30.914341, 22.000306, 47.393934 
2 step, MemGCRN, test, MSE, RMSE, MAE, MAPE, 197.032131, 14.036813, 8.882513, 21.679384 
3 step, MemGCRN, test, MSE, RMSE, MAE, MAPE, 143.986279, 11.999428, 7.649120, 15.201368 
4 step, MemGCRN, test, MSE, RMSE, MAE, MAPE, 191.452074, 13.836621, 8.699645, 18.994344 
5 step, MemGCRN, test, MSE, RMSE, MAE, MAPE, 209.836607, 14.485738, 9.159083, 21.937448 
6 step, MemGCRN, test, MSE, RMSE, MAE, MAPE, 154.623719, 12.434779, 7.913593, 17.918024 
Model Testing Ended ... Fri Feb  4 05:01:44 2022
